package all;

import java.util.Stack;

import all.BinaryTree.BinaryTreeNode;

public class Problem6ChecksIsABinaryTreeIsPerfectlyBalanced {

	public static BinaryTree<Integer> binaryTree;
	
	public static void main(String[] args) {
		binaryTree =
				new BinaryTree<Integer>(14,
						new BinaryTree<Integer>(19,
								new BinaryTree<Integer> (23),
								new BinaryTree<Integer> (6,
										new BinaryTree<Integer>(10),
										new BinaryTree<Integer>(21))),
						new BinaryTree<Integer>(15,
								new BinaryTree<Integer>(3),
								new BinaryTree<Integer>(16)));
		System.out.println(IsIdeallyBalanced());
	}

	
	public static void setDepthOfNodes(BinaryTreeNode<Integer> root, int depth) {
		if (root == null) {
			return;
		}
		// 1. Visit the root of this subtree.
		root.setDepth(depth);
		if (sumOfLevel.size() <= depth) {
			sumOfLevel.add(0);
		}
		sumOfLevel.set(depth, sumOfLevel.get(depth) + root.getValue());
		// 2. Visit the left child.
		setDepthOfNodes(root.getLeftChild(), depth + 1);
		// 3. Visit the right child.
		setDepthOfNodes(root.getRightChild(), depth + 1);
	}
	
	public static int countNodesDfs(BinaryTreeNode<Integer> root) {
		int nodesCount = 1;
		Stack<BinaryTreeNode<Integer>> currentNodes = new Stack<BinaryTreeNode<Integer>>();
		currentNodes.push(root);

		while (currentNodes.size() > 0) {
			BinaryTreeNode<Integer> currentNode = currentNodes.pop();
			if (currentNode.getLeftChild() != null) {
				currentNodes.push(currentNode.getLeftChild());
				nodesCount++;
			}
			if (currentNode.getRightChild() != null) {
				currentNodes.push(currentNode.getRightChild());
				nodesCount++;
			}
		}
		return nodesCount;
	}

	public static boolean IsIdeallyBalanced() {
		return IsIdeallyBalanced(binaryTree.getRoot());
	}

	public static boolean IsIdeallyBalanced(BinaryTreeNode<Integer> root)
	{
		long leftTreeNodesCount = 0;
		long rightTreeNodesCount = 0;

		if (root == null) {
			return true;
		}
		if (root.getLeftChild() != null) {
			leftTreeNodesCount = countNodesDfs(root.getLeftChild());
		}
		if (root.getRightChild() != null) {
			rightTreeNodesCount = countNodesDfs(root.getRightChild());
		}

		if (Math.abs(leftTreeNodesCount - rightTreeNodesCount) <= 1 &&
			IsIdeallyBalanced(root.getLeftChild()) == true &&
			IsIdeallyBalanced(root.getRightChild()) == true)
		{
			return true;
		}
		return false;
	}
}